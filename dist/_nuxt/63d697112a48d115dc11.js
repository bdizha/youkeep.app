(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{498:function(t,e,o){"use strict";o.r(e);o(198),o(145),o(91),o(45),o(128),o(146),o(144);var n={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",administrative_area_level_2:"county",country:"long_name",postal_code:"short_name"},r=["locality","administrative_area_level_3"],l=["locality","sublocality","postal_code","country","administrative_area_level_1","administrative_area_level_2"],c={name:"VueGoogleAutocomplete",props:{id:{type:String,required:!0},classname:String,placeholder:{type:String,default:"Start typing"},types:{type:String,default:"address"},country:{type:[String,Array],default:null},enableGeolocation:{type:Boolean,default:!1},geolocationOptions:{type:Object,default:null}},data:function(){return{autocomplete:null,autocompleteText:"",geolocation:{geocoder:null,loc:null,position:null}}},watch:{autocompleteText:function(t,e){this.$emit("inputChange",{newVal:t,oldVal:e},this.id)},country:function(t,e){this.autocomplete.setComponentRestrictions({country:null===this.country?[]:this.country})}},mounted:function(){var t={};this.types&&(t.types=[this.types]),this.country&&(t.componentRestrictions={country:this.country}),this.autocomplete=new google.maps.places.Autocomplete(document.getElementById(this.id),t),this.autocomplete.addListener("place_changed",this.onPlaceChanged)},methods:{onPlaceChanged:function(){var t=this.autocomplete.getPlace();t.geometry?void 0!==t.address_components&&(this.$emit("placechanged",this.formatResult(t),t,this.id),this.autocompleteText=document.getElementById(this.id).value,this.onChange()):this.$emit("no-results-found",t,this.id)},onFocus:function(){this.biasAutocompleteLocation(),this.$emit("focus")},onBlur:function(){this.$emit("blur")},onChange:function(){this.$emit("change",this.autocompleteText)},onKeyPress:function(t){this.$emit("keypress",t)},onKeyUp:function(t){this.$emit("keyup",t)},clear:function(){this.autocompleteText=""},focus:function(){this.$refs.autocomplete.focus()},blur:function(){this.$refs.autocomplete.blur()},update:function(t){this.autocompleteText=t},updateCoordinates:function(t){var e=this;(t||t.lat||t.lng)&&(this.geolocation.geocoder||(this.geolocation.geocoder=new google.maps.Geocoder),this.geolocation.geocoder.geocode({location:t},(function(t,o){"OK"===o?(t=e.filterGeocodeResultTypes(t))[0]?(e.$emit("placechanged",e.formatResult(t[0]),t[0],e.id),e.update(t[0].formatted_address)):e.$emit("error","no result for provided coordinates"):e.$emit("error","error getting address from coords")})))},geolocate:function(){var t=this;this.updateGeolocation((function(e,o){t.updateCoordinates(e)}))},updateGeolocation:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(navigator.geolocation){var o={};this.geolocationOptions&&Object.assign(o,this.geolocationOptions),navigator.geolocation.getCurrentPosition((function(o){var n={lat:o.coords.latitude,lng:o.coords.longitude};t.geolocation.loc=n,t.geolocation.position=o,e&&e(n,o)}),(function(e){t.$emit("error","Cannot get Coordinates from navigator",e)}),o)}},biasAutocompleteLocation:function(){var t=this;this.enableGeolocation&&this.updateGeolocation((function(e,o){var circle=new google.maps.Circle({center:e,radius:o.coords.accuracy});t.autocomplete.setBounds(circle.getBounds())}))},formatResult:function(t){for(var e={},i=0;i<t.address_components.length;i++){var o=t.address_components[i].types[0];if(n[o]){var r=t.address_components[i][n[o]];e[o]=r}}return e.latitude=t.geometry.location.lat(),e.longitude=t.geometry.location.lng(),e},filterGeocodeResultTypes:function(t){if(!t||!this.types)return t;var output=[],e=[this.types];e.includes("(cities)")&&(e=e.concat(r)),e.includes("(regions)")&&(e=e.concat(l));var o=!0,n=!1,c=void 0;try{for(var d,m=t[Symbol.iterator]();!(o=(d=m.next()).done);o=!0){var h=d.value,f=!0,y=!1,v=void 0;try{for(var _,x=h.types[Symbol.iterator]();!(f=(_=x.next()).done);f=!0){var C=_.value;if(e.includes(C)){output.push(h);break}}}catch(t){y=!0,v=t}finally{try{f||null==x.return||x.return()}finally{if(y)throw v}}}}catch(t){n=!0,c=t}finally{try{o||null==m.return||m.return()}finally{if(n)throw c}}return output}}},d=o(13),m={components:{VueGoogleAutocomplete:Object(d.a)(c,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{directives:[{name:"model",rawName:"v-model",value:t.autocompleteText,expression:"autocompleteText"}],ref:"autocomplete",class:t.classname,attrs:{type:"text",id:t.id,placeholder:t.placeholder},domProps:{value:t.autocompleteText},on:{focus:function(e){return t.onFocus()},blur:function(e){return t.onBlur()},change:t.onChange,keypress:t.onKeyPress,keyup:t.onKeyUp,input:function(e){e.target.composing||(t.autocompleteText=e.target.value)}}})}),[],!1,null,null,null).exports},props:{store:{type:Object,required:!1},hasTitle:{type:Boolean,required:!1,default:!1}},data:function(){return{formDelivery:this.$form.createForm(this,{name:"form_delivery"}),addresses:[],search:null,hasData:!1,isLoggedIn:!1,modal:{current:null,isVisible:!1}}},mounted:function(){},methods:{onSelect:function(address){var t=this;console.log("selecting address: ",address);var path="/locations/address";console.log("auto completing address search >>>> "+path);var e=this;e.isLoggedIn=e.$store.state.isLoggedIn,axios.post(path,{data:address}).then((function(o){console.log(o.data);var address=o.data.address;e.$store.commit("onAddress",address),e.isLoggedIn||(e.modal.isVisible=!0,e.modal.current="login",e.$store.commit("onModal",t.modal)),console.log("set address >> after")})).catch((function(t){console.log(t)}))},onKeyPress:function(t){console.log("typing address: ",t)},onSearch:function(t){this.search=t;var path="/locations/"+this.search;console.log("auto completing address search >>>> "+path);var e=this;axios.get(path,{}).then((function(t){console.log("setting addresses >> before"),console.log(t.data),e.addresses=t.data.addresses,e.hasData=!0,console.log("setting addresses >> after")})).catch((function(t){console.log(t)}))},handleError:function(){}}},h=Object(d.a)(m,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"r-delivery"},[o("a-form",{staticClass:"ant-form ant-form-vertical",attrs:{form:t.formDelivery}},[t.hasTitle?o("a-form-item",[o("a-row",{attrs:{type:"flex",justify:"center"}},[o("a-col",{staticClass:"gutter-row r-text-left",attrs:{xs:{span:24}}},[o("h2",{staticClass:"r-heading"},[o("span",[t._v("Enter delivery address")])])])],1)],1):t._e(),t._v(" "),o("a-form-item",[o("a-auto-complete",{staticStyle:{width:"100%"},attrs:{dropdownClassName:"certain-category-search-dropdown",dropdownMatchSelectWidth:!1,dropdownStyle:{width:"100%"},size:"large",placeholder:"Enter your delivery address",optionLabelProp:"value"},on:{select:t.onSelect,search:t.onSearch}},[o("template",{slot:"dataSource"},t._l(t.addresses,(function(address,e){return o("a-select-option",{key:address.description+e,attrs:{value:address.main_text},on:{click:function(e){return t.onSelect(address,e)}}},[o("div",{staticClass:"r-address-line"},[o("div",{staticClass:"r-address-icon"},[o("a-icon",{attrs:{type:"environment"}})],1),t._v(" "),o("div",{staticClass:"r-address-content"},[o("div",{staticClass:"r-address-main"},[t._v("\n                                    "+t._s(address.main_text)+"\n                                ")]),t._v(" "),o("div",{staticClass:"r-address-secondary"},[t._v("\n                                    "+t._s(address.secondary_text)+"\n                                ")])])])])})),1),t._v(" "),o("a-input",{attrs:{size:"large"},on:{keypress:t.onKeyPress}},[o("a-icon",{attrs:{slot:"prefix",type:"environment"},slot:"prefix"}),t._v(" "),o("a-button",{staticClass:"r-search-btn",staticStyle:{"margin-right":"-12px"},attrs:{slot:"suffix",size:"large",type:"primary"},slot:"suffix"},[t._v("\n                        Let's go\n                    ")])],1)],2)],1)],1)],1)}),[],!1,null,null,null);e.default=h.exports}}]);